# Adopción de pautas de seguridad informática
- Seguridad lógica:
  - Criptografía. Cifrado de clave secreta (simétrica o privada). Cifrado de clave pública (asimétrica). Funciones de mezcla o resumen (hash).
    - https://github.com/jesusninoc/ClasesSAD/blob/master/2019-10-09.md#cifrar-con-un-algoritmo-sencillo-el-nombre-y-el-contenido-de-un-fichero-de-texto
    - https://github.com/jesusninoc/ClasesSAD/blob/master/2019-10-09.md#descifrar-el-siguiente-texto
    - https://www.jesusninoc.com/02/28/seguridad-informatica-con-powershell/#Criptografia
    - https://github.com/jesusninoc/ClasesPSP/blob/master/2019-03-06.md
    - https://github.com/jesusninoc/ClasesPSP/blob/master/2019-03-07.md
    - https://github.com/jesusninoc/ClasesSeguridad/blob/master/2018-10-30.md
    - https://github.com/jesusninoc/ClasesSeguridad/blob/master/2018-10-31.md
    - https://github.com/jesusninoc/ClasesSeguridad/blob/master/2019-01-23.md#ejercicio-de-powershell--generar-sha1-con-las-palabras-de-un-diccionario
    - https://blog.wpsec.com/cracking-wordpress-passwords-with-hashcat/
    - https://ehikioya.com/wordpress-password-hash-generator/

--------------------

# Ejercicio
## Descifrar el siguiente texto
* https://github.com/jesusninoc/ClasesPSP/blob/master/2019-02-21.md#descrifrar-el-siguiente-texto
* https://github.com/jesusninoc/ClasesPSP/blob/master/2019-02-25.md

## Detectar mediante firmas que un fichero se ha infectado
```PowerShell
mkdir prueba
cd .\prueba

"hola" > hola.txt

ForEach($fichero in ls .)
{
    $ficheronuevo = "$fichero.hash"
    (Get-FileHash $fichero).hash > $ficheronuevo
}

ForEach($fichero in ls .)
{
#Cifrar el contenido del fichero
$cifrado=gc $fichero
$var=1
$textocifrado=(0..($cifrado.Length-1) | % {[char]::ConvertFromUtf32([char]::ConvertToUtf32($cifrado[$_].ToString(),0)-$var)}) -join ""

#Cifrar el nombre y añadir el contenido cifrado
#Quitamos los puntos y otros caracteres para no tener errores a la hora de crear el nuevo fichero cifrado
$ficherosin=$fichero.Name.Replace(".","")
$ficherosin
$ficherocifrado=(0..($ficherosin.Length-1) | % {[char]::ConvertFromUtf32([char]::ConvertToUtf32($ficherosin[$_].ToString(),0)-$var)}) -join ""
$textocifrado | Out-File $ficherocifrado
}

ForEach($fichero in ls . -File)
{
    if((Get-FileHash $fichero).hash -eq (gc .\hashes\hola.txt.hash))
    {
        "es igual"
    }
    else
    {
        "es distinto"
    }
}
```

## Adivinar un hash utilizando un fichero con hashes generados

```PowerShell
$hash = Read-Host "Introduzca hash: "

[Reflection.Assembly]::LoadWithPartialName("System.Web")

gc .\diccionario.txt | %{
$_+","+([System.Web.Security.FormsAuthentication]::HashPasswordForStoringInConfigFile($_, "SHA1")) >> dichash.txt
}

gc .\dichash.txt | Select-String $hash
```
